<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:text="${survey != null ? survey.title : 'Survey'}">Survey Form</title>

  <style>
    body { font-family: Arial; background:#f7f8fa; padding:40px; }
    h2 { color:#004aad; text-align:center; }
    form {
      background:white; max-width:800px; margin:30px auto;
      padding:30px; border-radius:10px; box-shadow:0 0 10px #ccc;
    }
    .question {
      margin-bottom:25px; padding:15px; border-bottom:1px solid #eee;
    }
    label { font-weight:bold; margin-bottom:10px; display:block; }
    textarea, input[type="text"], select {
      width:100%; padding:8px; border:1px solid #ccc; border-radius:6px;
    }
    .option-group label { display:inline-block; margin-right:15px; }
    button {
      background:#004aad; padding:10px 25px; border:none;
      color:white; border-radius:6px; cursor:pointer;
    }
    button:hover { background:#00348f; }
  </style>
</head>

<body>

<h2 th:text="'Survey: ' + ${survey != null ? survey.title : ''}"></h2>

<form th:action="@{'/survey/' + ${survey.id} + '/submit'}" method="post">

  <!-- SAFE fallback: if employee is null, don't explode -->
  <input type="hidden"
         name="employeeId"
         th:value="${employee != null ? employee.employeeId : ''}" />

  <div th:each="q : ${survey.questions}" class="question">

    <label th:text="${q.text}">Question Text</label>

    <!-- TEXT -->
    <div th:if="${q.questionType == 'TEXT'}">
      <input type="text" th:name="'q_' + ${q.id}" placeholder="Enter your answer..." />
    </div>

    <!-- TEXTAREA -->
    <div th:if="${q.questionType == 'TEXTAREA'}">
      <textarea th:name="'q_' + ${q.id}" rows="3" placeholder="Enter your answer..."></textarea>
    </div>

    <!-- RADIO -->
    <div th:if="${q.questionType == 'RADIO'}" class="option-group">
      <div th:each="opt : ${#strings.arraySplit(q.options, ',')}">
        <label>
          <input type="radio" th:name="'q_' + ${q.id}" th:value="${opt.trim()}">
          <span th:text="${opt.trim()}"></span>
        </label>
      </div>
    </div>

    <!-- CHECKBOX -->
    <div th:if="${q.questionType == 'CHECKBOX'}" class="option-group">
      <div th:each="opt, iter : ${#strings.arraySplit(q.options, ',')}">
        <label>
          <input type="checkbox"
                 th:name="'q_' + ${q.id} + '_' + ${iter.index}"
                 th:value="${opt.trim()}">
          <span th:text="${opt.trim()}"></span>
        </label>
      </div>
    </div>

    <!-- DROPDOWN -->
    <div th:if="${q.questionType == 'DROPDOWN'}">
      <select th:name="'q_' + ${q.id}">
        <option value="">-- select --</option>
        <option th:each="opt : ${#strings.arraySplit(q.options, ',')}"
                th:value="${opt.trim()}"
                th:text="${opt.trim()}"></option>
      </select>
    </div>

  </div>

  <div style="text-align:center">
    <button type="submit">Submit Survey</button>
  </div>
</form>

</body>
</html>
